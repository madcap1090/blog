<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>members of the chamber of representatives of Belgium, 54th legistlature | bad to the code</title>

<meta property='og:title' content='members of the chamber of representatives of Belgium, 54th legistlature - bad to the code'>
<meta property='og:description' content='For a country as small as Belgium 6 governments is a lot. Its maybe because we Belgians like to be governed and governed well. Why else would we pay for all of them, their administration and their parliaments?
We also love politicians, so we want to have a lot of them. I also like politicians so I decided to do some NLP on their tweets. But since there are a significant number of them I searched for an objective criteria to subset them.'>
<meta property='og:url' content='/post/members-of-the-chamber-of-representatives-of-belgium-54th-legistlature/'>
<meta property='og:site_name' content='bad to the code'>
<meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/5f460ebf37e30791f47bb5be3de73e3a?s=256'><meta property='article:author' content='https://facebook.com/OClassicoOficial/videos/391802167961744/'><meta property='article:section' content='Post'><meta property='article:tag' content='scraping'><meta property='article:tag' content='Belgian politics'><meta property='article:tag' content='magick'><meta property='article:tag' content='purrr'><meta property='article:published_time' content='2019-04-17T00:00:00Z'/><meta property='article:modified_time' content='2019-04-17T00:00:00Z'/><meta name='twitter:card' content='summary'><meta name='twitter:site' content='@WilliamBourgeoi'><meta name='twitter:creator' content='@WilliamBourgeoi'>


<link href="/index.xml" rel="alternate" type="application/rss+xml" title="bad to the code" />

<link rel="stylesheet" href="/css/style.css"/><link rel='stylesheet' href='/css/custom.css'><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
<section class="section">
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <a class="nav-item" href="/">
          <h1 class="title is-4">bad to the code</h1>
        </a>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile"><a class="level-item" aria-label="facebook" href='https://facebook.com/OClassicoOficial/videos/391802167961744/'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="email" href='mailto:madcap1090@gmail.com'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="linkedin" href='https://linkedin.com/in/williambourgeois'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="twitter" href='https://twitter.com/WilliamBourgeoi'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="github" href='https://github.com/madcap1090'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
</section>
<section class="section">
  <div class="container">
    <div class="subtitle tags is-6 is-pulled-right">
      
      
<a class="subtitle is-6" href="/tags/scraping">#scraping</a>



  
  | <a class="subtitle is-6" href="/tags/belgian-politics">#Belgian politics</a>
  
  | <a class="subtitle is-6" href="/tags/magick">#magick</a>
  
  | <a class="subtitle is-6" href="/tags/purrr">#purrr</a>
  

      
    </div>
    <h2 class="subtitle is-6">April 17, 2019</h2>
    <h1 class="title">members of the chamber of representatives of Belgium, 54th legistlature</h1>
    
    <div class="content">
      


<p>For a country as small as Belgium 6 governments is a lot. Its maybe because we Belgians like to be governed and governed well. Why else would we pay for all of them, their administration and their parliaments?</p>
<p>We also love politicians, so we want to have a lot of them. I also like politicians so I decided to do some NLP on their tweets. But since there are a significant number of them I searched for an objective criteria to subset them. What better selection then the members of the national chamber of representatives? They were elected to represent us all at the national level after all.</p>
<p><a href="https://www.dekamer.be" class="uri">https://www.dekamer.be</a> is the official website of the chamber. Two lists are interesting here. One has the current membres, the other one the complete list of members that at one moment or another were part of the parlaiment during the 54th legistlature following the 2014 elections.</p>
<p>Let‚Äôs scrape them.</p>
<pre class="r"><code>library(&quot;tidyverse&quot;)
library(&quot;rvest&quot;)
library(&quot;XML&quot;)
library(&quot;glue&quot;)
library(&quot;magick&quot;)</code></pre>
<pre class="r"><code>url &lt;- &quot;http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=/site/wwwcfm/depute/cvlist54.cfm&quot;

table &lt;- url %&gt;% 
  read_html() %&gt;% 
  html_nodes(&quot;#story &gt; table&quot;) %&gt;% 
  html_table()

table &lt;- table[[1]] # extracting the dataframe

names(table) &lt;- c(&quot;ln_fn&quot;, &quot;party&quot;, &quot;d1&quot;, &quot;d2&quot;)
table &lt;- table %&gt;% 
  select(ln_fn, party) %&gt;% 
  arrange(ln_fn)

head(table)</code></pre>
<pre><code>##                                  ln_fn       party
## 1                        Almaci Meyrem Ecolo-Groen
## 2                           Becq Sonja        CD&amp;V
## 3 Beke                          Wouter        CD&amp;V
## 4                         Bellens Rita        N-VA
## 5                      Ben Hamou Nawal          PS
## 6                   Blanchart Philippe          PS</code></pre>
<p>Funny that all the white spaces between ‚ÄúBeke‚Äù and ‚ÄúWouter‚Äù cannot be seen. But they need to be cleaned.</p>
<pre class="r"><code>table &lt;- table %&gt;%
  mutate(ln_fn = (str_replace_all(ln_fn,&quot;  +&quot;,&quot; &quot;)),
         ln_fn = trimws(table$ln_fn, which = &quot;both&quot;))

table$ln_fn &lt;- str_replace_all(table$ln_fn,&quot;  +&quot;,&quot; &quot;)
table$ln_fn &lt;- trimws(table$ln_fn, which = &quot;both&quot;) # for good measure
nrow(table)</code></pre>
<pre><code>## [1] 150</code></pre>
<p>150 members today with their current polical party. I‚Äôm goin to save that data, because after the elections of next month it will not be available for a long time.</p>
<pre class="r"><code>saveRDS(table, &quot;~/R/blog/content/post/data/190417/reps_54_190417.rds&quot;)</code></pre>
<p>And the parties are:</p>
<pre class="r"><code>table %&gt;% 
  group_by(party) %&gt;% 
  summarise(members=n()) %&gt;% 
  arrange(desc(members))</code></pre>
<pre><code>## # A tibble: 14 x 2
##    party        members
##    &lt;chr&gt;          &lt;int&gt;
##  1 N-VA              31
##  2 PS                23
##  3 MR                20
##  4 CD&amp;V              17
##  5 Open Vld          14
##  6 sp.a              13
##  7 Ecolo-Groen       12
##  8 cdH                9
##  9 VB                 3
## 10 D√©FI               2
## 11 PTB-GO!            2
## 12 Vuye&amp;Wouters       2
## 13 ONAFH              1
## 14 PP                 1</code></pre>
<p>We can also scrape the complete list of members of the 54th legistlature.</p>
<pre class="r"><code>url &lt;- &quot;https://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvlist54.cfm?legis=54&amp;today=n&quot;

table_54 &lt;- url %&gt;% 
  read_html() %&gt;% 
  html_nodes(&quot;#story &gt; table&quot;) %&gt;% 
  html_table()

table_54 &lt;- table_54[[1]] # extracting the dataframe

names(table_54) &lt;- c(&quot;ln_fn&quot;, &quot;d1&quot;, &quot;d2&quot;, &quot;d3&quot;)  
table_54 &lt;- table_54 %&gt;% 
  select(ln_fn) %&gt;% 
  arrange(ln_fn)

table_54 &lt;- table_54 %&gt;%
  mutate(ln_fn = (str_replace_all(ln_fn,&quot;  +&quot;,&quot; &quot;)),
         ln_fn = trimws(ln_fn, which = &quot;both&quot;))

table$ln_fn &lt;- str_replace_all(table$ln_fn,&quot;  +&quot;,&quot; &quot;)
table$ln_fn &lt;- trimws(table$ln_fn, which = &quot;both&quot;) # for good measure</code></pre>
<p>This table does not mention the party, which is a pity because some members have changed since 2014.</p>
<p>Who has left ?</p>
<pre class="r"><code>table_54 %&gt;% 
  anti_join(table) %&gt;% 
  unlist() %&gt;% 
  unname()</code></pre>
<pre><code>##  [1] &quot;Bacquelaine Daniel&quot;      &quot;Claerhout Sarah&quot;        
##  [3] &quot;Crusni√®re St√©phane&quot;      &quot;De Block Maggie&quot;        
##  [5] &quot;De Crem Pieter&quot;          &quot;De Croo Alexander&quot;      
##  [7] &quot;Demeyer Willy&quot;           &quot;Ducarme Denis&quot;          
##  [9] &quot;Flahaut Andr√©&quot;           &quot;Fremault C√©line&quot;        
## [11] &quot;Geens Koen&quot;              &quot;Gerkens Muriel&quot;         
## [13] &quot;Hellings Benoit&quot;         &quot;Hufkens Renate&quot;         
## [15] &quot;Khattabi Zakia&quot;          &quot;Klaps Johan&quot;            
## [17] &quot;Lahaye-Battheu Sabien&quot;   &quot;Marghem Marie-Christine&quot;
## [19] &quot;Massin Eric&quot;             &quot;Michel Charles&quot;         
## [21] &quot;Poncelet Isabelle&quot;       &quot;Raskin Wouter&quot;          
## [23] &quot;Reynders Didier&quot;         &quot;Turtelboom Annemie&quot;     
## [25] &quot;Van der Donckt Wim&quot;      &quot;Vande Lanotte Johan&quot;    
## [27] &quot;Vanheste Ann&quot;            &quot;Wathelet Melchior&quot;      
## [29] &quot;Wilm√®s Sophie&quot;</code></pre>
<p>So indeed 29 representatives. But some left to work in the government and then came back when their party decided to leave government because of a city in northen Africa. Go figure.</p>
<p>But it does make the identification of a tweet as a tweet being sent by a member of parlaiment a little bit more complicated because we need to match the exact date of the tweet to the periods the politician was seating. I have a feeling this will imply some stupid hardcoding also.</p>
<p>Let‚Äôs have some fun first. Looking at the page of the current members of parlaiment, and more specifically at the url leading to the members page, their identifier can be discovered. For instance Mrs Almaci has id 01189 for the website. So once the xpath is known its is relatively easy to extract the indivdual member‚Äôs webpage url.</p>
<pre class="r"><code>url &lt;- &quot;http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=/site/wwwcfm/depute/cvlist54.cfm&quot;
url &lt;- &quot;http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvlist54.cfm?legis=54&amp;today=n&quot;
page &lt;- url %&gt;% 
  read_html() %&gt;% 
  html_nodes(xpath=  &#39;//*[@id=&quot;story&quot;]/table&#39;) 

# loop to get urls
urls &lt;- tibble()

for(i in 1:nrow(table_54)){
  url &lt;- xml_attrs(xml_child(xml_child(xml_child(page[[1]], i), 1), 1))
  url &lt;- unname(url)
  name &lt;- table_54$ln_fn[i]
  url &lt;- cbind(name, url)
  urls &lt;- rbind(urls, url)
}

table_ids &lt;- urls %&gt;%
  mutate(url = paste0(&quot;http://www.dekamer.be/kvvcr/&quot;, url))   # constructing the url
  
head(table_ids)</code></pre>
<pre><code>##                 name
## 1      Almaci Meyrem
## 2 Bacquelaine Daniel
## 3         Becq Sonja
## 4        Beke Wouter
## 5       Bellens Rita
## 6    Ben Hamou Nawal
##                                                                                                            url
## 1 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=01189&amp;lactivity=54
## 2 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=00757&amp;lactivity=54
## 3 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=01190&amp;lactivity=54
## 4 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=01149&amp;lactivity=54
## 5 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=06592&amp;lactivity=54
## 6 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=06647&amp;lactivity=54</code></pre>
<p>But there is a problem with matching the names and the ids.</p>
<pre class="r"><code>x &lt;- table_ids

names &lt;- tibble()

for (i in (1:nrow(x))){
  url &lt;- x$url[i]
  fn_ln &lt;- url %&gt;%
    read_html() %&gt;%
    html_nodes(xpath=  &#39;//*[@id=&quot;myform&quot;]/center/h2&#39;) %&gt;% 
    html_text() %&gt;% 
    as.data.frame()
  info &lt;- cbind(fn_ln, url)
  names &lt;- rbind(names, info)
}

names(names) &lt;- c(&quot;fn_ln&quot;,&quot;url&quot;)

names &lt;- names %&gt;% 
  mutate(fn_ln =(str_replace_all(fn_ln,&quot;  +&quot;,&quot; &quot;)))

head(names)</code></pre>
<pre><code>##                fn_ln
## 1      Meyrem Almaci
## 2 Daniel Bacquelaine
## 3         Sonja Becq
## 4       Wouter Beke 
## 5       Rita Bellens
## 6    Nawal Ben Hamou
##                                                                                                            url
## 1 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=01189&amp;lactivity=54
## 2 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=00757&amp;lactivity=54
## 3 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=01190&amp;lactivity=54
## 4 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=01149&amp;lactivity=54
## 5 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=06592&amp;lactivity=54
## 6 http://www.dekamer.be/kvvcr/showpage.cfm?section=/depute&amp;language=nl&amp;cfm=cvview54.cfm?key=06647&amp;lactivity=54</code></pre>
<p>So we need to correct that the ids and fn_ln are correct so? so build a key based on the letters in the name of the person</p>
<pre class="r"><code>str_sort &lt;- function(x)
  sapply(lapply(strsplit(x, NULL), sort), paste, collapse=&quot;&quot;)

w_key &lt;- table_ids %&gt;% 
  mutate(key = tolower(str_replace_all(name,&quot; &quot;,&quot;&quot;))) %&gt;% 
  mutate(key = str_sort(key)) %&gt;% 
  select(-url)

names_w_key &lt;- names %&gt;% 
  mutate(key = tolower(str_replace_all(fn_ln,&quot; &quot;,&quot;&quot;))) %&gt;% 
  mutate(key = str_sort(key))

names &lt;- names_w_key %&gt;% 
  left_join(w_key) %&gt;% 
  rename(&quot;ln_fn&quot; = &quot;name&quot;)

names %&gt;% 
  select(-url) %&gt;% 
  head()</code></pre>
<pre><code>##                fn_ln               key              ln_fn
## 1      Meyrem Almaci      aaceeilmmmry      Almaci Meyrem
## 2 Daniel Bacquelaine aaabcdeeeiillnnqu Bacquelaine Daniel
## 3         Sonja Becq         abcejnoqs         Becq Sonja
## 4       Wouter Beke         beeekortuw        Beke Wouter
## 5       Rita Bellens       abeeillnrst       Bellens Rita
## 6    Nawal Ben Hamou     aaabehlmnnouw    Ben Hamou Nawal</code></pre>
<p>Seems to work. Names are clean. Now the id code is needed.</p>
<pre class="r"><code># correct id

names &lt;- names %&gt;%
  mutate(id = gsub(&#39;^.*key=*|\\s*&amp;lact.*$&#39;,&#39;&#39;, url))               # extract their id from the url
  #mutate(id = gsub(&#39;O&#39;,&#39;0&#39;,id))      # some of them have O instead of 0 but we need to keep them</code></pre>
<p>So now we have in ‚Äòurls‚Äô the name and links to the personal webpage of the representatives on the chamber‚Äôs website. Notice their id at the end of the url after ‚Äòcfm?key=‚Äô and before ‚Äò&amp;lat‚Äô.</p>
<p>Let‚Äôs get their mugshots.</p>
<div class="figure">
<img src="/img/20190417/inspect.png" alt="Inspecting the code of the webpage" />
<p class="caption">Inspecting the code of the webpage</p>
</div>
<p>So the images are in <a href="http://www.dekamer.be/site/wwwroot/images/cv/" class="uri">http://www.dekamer.be/site/wwwroot/images/cv/</a></p>
<pre class="r"><code># let&#39;s try purrr again

download_gifs &lt;- function (name, id){
  url_pic &lt;- glue(&quot;http://www.dekamer.be/site/wwwroot/images/cv/{id}.gif&quot;)
  download.file(url_pic, destfile = glue(&quot;./data/190417/{name}.gif&quot;), mode = &quot;wb&quot;)
}

#download_gifs(&quot;test&quot;,&quot;01203&quot;)</code></pre>
<p>So that seems to work. Unfortunately while scraping it is not infrequent to encounter coding inconsistencies. For instance member ‚Äú00902‚Äù does not have a ‚Äú00902.gif‚Äù his is ‚Äú902.gif‚Äù. Dirty data üö®, shame on you webmaster üòâ.</p>
<pre class="r"><code>#table_ids %&gt;% 
#  map2(.x = name, .y = id, .f = download_gifs)

# 
# table_ids$id[table_ids$id == &quot;00902&quot;] &lt;- 902
# table_ids$id[table_ids$id == &quot;06918&quot;] &lt;- 6918
# table_ids$id[table_ids$id == &quot;06536&quot;] &lt;- 6536
# table_ids$id[table_ids$id == &quot;00951&quot;] &lt;- 951
# table_ids$id[table_ids$id == &quot;06325&quot;] &lt;- 6325
# table_ids$id[table_ids$id == &quot;06885&quot;] &lt;- 6885
# table_ids$id[table_ids$id == &quot;06665&quot;] &lt;- 6665
# table_ids$id[table_ids$id == &quot;01123&quot;] &lt;- 1123
# table_ids$id[table_ids$id == &quot;06843&quot;] &lt;- 6843

map2(.x = table_ids$name, .y = table_ids$id, .f = download_gifs)</code></pre>
<pre><code>## list()</code></pre>
<p>So sometimes the 0 is used and sometimes it is just the value withhout leading 0. One possible solution is to enhance the ‚Äòdownload_gifs‚Äô function.</p>
<pre class="r"><code>download_gifs_with_0 &lt;- function (name, id){
  url_pic &lt;- glue(&quot;http://www.dekamer.be/site/wwwroot/images/cv/{id}.gif&quot;)
  download.file(url_pic, destfile = glue(&quot;./data/190417/down_1/{name}.gif&quot;), mode = &quot;wb&quot;)
}

download_gifs_no_0 &lt;- function (name, id){
  id &lt;- as.numeric(id)
  url_pic &lt;- glue(&quot;http://www.dekamer.be/site/wwwroot/images/cv/{id}.gif&quot;)
  download.file(url_pic, destfile = glue(&quot;./data/190417/down_2/{name}.gif&quot;), mode = &quot;wb&quot;)
}</code></pre>
<p>Trying to simplify the use of the purrr function safely, by Lionel Henry who I thank for his work &amp; presentation at the RUser2018 conference in Budapest.</p>
<p>So using ‚Äòsafely‚Äô the error are being skipped and we managed to download how many files?</p>
<pre class="r"><code>length(list.files(&quot;./data/190417/down_1&quot;))</code></pre>
<pre><code>## [1] 160</code></pre>
<p>Only few missing. Let‚Äôs use the other function.</p>
<pre class="r"><code>length(list.files(&quot;./data/190417/down_2&quot;))</code></pre>
<pre><code>## [1] 96</code></pre>
Hmm so now we have too many pictures (and the ones with no leading 0 seem older). See the aging of Mr Calvo:
<center>
<p><img src="/img/20190417/Calvo%20Kristof_young.gif" alt="Young Mr Calvo" /> <img src="/img/20190417/Calvo%20Kristof_06128_old.gif" alt="Old Mr Calvo" /></p>
</center>
<p>And it seems some are still missing üòí.</p>
<p>Whose pics were additionally obtained?</p>
<pre class="r"><code>new &lt;- list.files(&quot;./data/190417/down_1&quot;)
old &lt;- list.files(&quot;./data/190417/down_2&quot;)
new_pics &lt;- setdiff(old, new)
new_pics</code></pre>
<pre><code>##  [1] &quot;Chabot Jacques.gif&quot;       &quot;Claerhout Sarah.gif&quot;     
##  [3] &quot;Crusni√®re St√©phane.gif&quot;   &quot;Dallemagne Georges.gif&quot;  
##  [5] &quot;Devin Laurent.gif&quot;        &quot;Gabri√´ls Katja.gif&quot;      
##  [7] &quot;Galant Isabelle.gif&quot;      &quot;Gustin Luc.gif&quot;          
##  [9] &quot;Hufkens Renate.gif&quot;       &quot;Janssens Dirk.gif&quot;       
## [11] &quot;Klaps Johan.gif&quot;          &quot;Miller Richard.gif&quot;      
## [13] &quot;Raskin Wouter.gif&quot;        &quot;Scourneau Vincent.gif&quot;   
## [15] &quot;Van Hoof Els.gif&quot;         &quot;Van Peteghem Vincent.gif&quot;
## [17] &quot;Vanden Burre Gilles.gif&quot;  &quot;Vuye Hendrik.gif&quot;        
## [19] &quot;Wilm√®s Sophie.gif&quot;</code></pre>
<p>Nice guy, Georges. Recently became grandfather again.</p>
<p>So are we missing some?</p>
<pre class="r"><code>fileslist &lt;- list.files(&quot;./data/190417&quot;)
fileslist &lt;-grep(&quot;.gif&quot;,fileslist,value=TRUE)
length(fileslist)</code></pre>
<pre><code>## [1] 179</code></pre>
<p>Looks promising. But double checking can not harm.</p>
<pre class="r"><code>names_list &lt;- gsub(&quot;.gif&quot;,&quot;&quot;,fileslist)
setdiff(names_list, names$ln_fn)</code></pre>
<pre><code>## character(0)</code></pre>
<p>üÜí we have a picture of all of them.</p>
<pre class="r"><code>dir.create(&quot;./data/190417/cols&quot;)</code></pre>
<pre><code>## Warning in dir.create(&quot;./data/190417/cols&quot;): &#39;.\data\190417\cols&#39; already
## exists</code></pre>
<pre class="r"><code>getwd()</code></pre>
<pre><code>## [1] &quot;C:/Users/William/Documents/R/blog/content/post&quot;</code></pre>
<pre class="r"><code>files &lt;- dir(&quot;data/190417/patch&quot;, full.names = TRUE)
set.seed(1)
files &lt;- sample(files, length(files))
gmp::factorize(length(files))</code></pre>
<pre><code>## Big Integer (&#39;bigz&#39;) :
## [1] 179</code></pre>
<pre class="r"><code>no_rows &lt;- 11
no_cols &lt;- 16

make_column &lt;- function(i, files, no_rows){
  image_read(files[(i*no_rows+1):((i+1)*no_rows)]) %&gt;%
  image_append(stack = TRUE) %&gt;%
    image_write(paste0(&quot;cols/&quot;, i, &quot;.jpg&quot;))
}


fun &lt;- function(i, files, no_rows){
  image_read(files[(i*no_rows+1):((i+1)*no_rows)]) %&gt;%
  image_append(stack = TRUE) %&gt;%
    image_write(paste0(&quot;./data/190417/cols/&quot;, i, &quot;.jpg&quot;))
}

# could not really make wal function ;-(

for(i in (0:(no_cols-1))) {
fun(i, files, no_rows)
}</code></pre>
<p>So we have the columns. Still need to bind them together.</p>
<pre class="r"><code>getwd()</code></pre>
<pre><code>## [1] &quot;C:/Users/William/Documents/R/blog/content/post&quot;</code></pre>
<pre class="r"><code>x &lt;- image_read(dir(&quot;.data/190417/cols/&quot;, full.names = TRUE))

img &lt;- image_read(dir(&quot;data/190417/cols/&quot;, full.names = TRUE)) %&gt;%
image_append(stack = FALSE) 

setwd(&quot;./files/20190417&quot;)
getwd()</code></pre>
<pre><code>## [1] &quot;C:/Users/William/Documents/R/blog/content/post/files/20190417&quot;</code></pre>
<pre class="r"><code>image_write(img,&quot;2019-04-17-faces_of_54.jpg&quot;)</code></pre>
<pre class="r"><code>unlink(&quot;./data/190417/patch&quot;, recursive = TRUE) # don&#39;t need those anymore</code></pre>
<center>
<div class="figure">
<img src="/img/20190417/2019-04-17-faces_of_54.jpg" alt="Old Mr Calvo" width="750" height="900" />
<p class="caption">Old Mr Calvo</p>
</div>
</center>
<p>So looking at the picture I will let you judge how diverse the picture looks. Less diverse than our national soccer team, that is for sure. But those are indeed two very small samples of Belgians, and they are from different generations.</p>
<p>What I can says is that given my age, gender and skin color, I would fit right in.</p>
<p>Wondering what the 55 legislature will look like. Will keep you posted.</p>
<p>But wait a minute. Did I say belgian national soccer teams? Hold my beer.</p>
<pre class="r"><code># for(i in (1:10000)){
# print(i)
# url_pic &lt;- glue(&quot;https://belgianfootball.s3.eu-central-1.amazonaws.com/s3fs-public/rbfa/img/players/internationals/football/men/{i}.jpg&quot;)
# safely(download.file(url_pic, destfile = glue(&quot;./content/post/data/190417/{i}.jpeg&quot;, mode = &quot;wb&quot;)),otherwise = NULL)
# }</code></pre>

      
      <div class="related">
</div>
      
    </div>
    
  </div>
</section>


<section class="section">
  <div class="container">
    <aside><div id="disqus_thread"></div></aside>
  
    <div id="show_comments"><a id="load_comments" class="button is-link">Load comments</a></div>
  
    <script type="text/javascript">
      var disqus_shortname = 'bad-to-the-code';
      function disqus() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }
  
      
      var hash = window.location.hash.substr(1);
      if ((hash.length > 8) && (hash.substring(0, 8) === "comment-")) {
        disqus();
        document.getElementById("show_comments").style.display = "none";
      } else {
        document.getElementById('load_comments').onclick = function() {
          disqus();
          document.getElementById("show_comments").style.display = "none";
        };
      }
  

    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>
</section>


<section class="section">
  <div class="container has-text-centered">
    <p>&copy; <a href="https://github.com/madcap1090">William Bourgeois</a> 2019</p>
    
      <p>Powered by <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/ribice/kiss">Kiss</a>.</p>
    
  </div>
</section>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-137981534-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="\/\/matomo.example.com\/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript>
  <img src="//matomo.example.com/piwik.php?idsite=1&amp;rec=1" style="border:0" alt="" />
</noscript>


</body>
</html>

